cubes:
  - name: survey_form
    # sql_table: survey_form
    sql: >
      SELECT * FROM survey_form WHERE 1 = 1
      {% if COMPILE_CONTEXT.securityContext.respondedAtFrom %}
        AND survey_form.responded_at >= '{{ COMPILE_CONTEXT.securityContext.respondedAtFrom }}'
      {% endif %}
      {% if COMPILE_CONTEXT.securityContext.respondedAtTo %}
        AND survey_form.responded_at <= '{{ COMPILE_CONTEXT.securityContext.respondedAtTo }}'
      {% endif %}
      {% if COMPILE_CONTEXT.securityContext.companyUserIds %}
        AND survey_form.company_user_id IN (
          {% for id in COMPILE_CONTEXT.securityContext.companyUserIds %}
            '{{ id }}'{% if not loop.last %}, {% endif %}
          {% endfor %}
        )
      {% endif %}
      {% if COMPILE_CONTEXT.securityContext.candidateProfileIds %}
        AND survey_form.candidate_profile_id IN (
          {% for id in COMPILE_CONTEXT.securityContext.candidateProfileIds %}
            '{{ id }}'{% if not loop.last %}, {% endif %}
          {% endfor %}
        )
      {% endif %}
      {% if COMPILE_CONTEXT.securityContext.candidateApplicationIds %}
        AND survey_form.candidate_application_id IN (
          {% for id in COMPILE_CONTEXT.securityContext.candidateApplicationIds %}
            '{{ id }}'{% if not loop.last %}, {% endif %}
          {% endfor %}
        )
      {% endif %}
    joins:
      - name: survey_form_template
        sql: '{CUBE}.survey_form_template_id = {survey_form_template}.id'
        relationship: many_to_one
      - name: candidate_application
        sql: '{CUBE}.candidate_application_id = {candidate_application}.id'
        relationship: many_to_one
      - name: company_user
        sql: '{CUBE}.company_user_id = {company_user}.id'
        relationship: many_to_one
      - name: candidate_profile
        sql: '{CUBE}.candidate_profile_id = {candidate_profile}.id'
        relationship: many_to_one
      - name: survey_form_question_answer
        sql: "{CUBE}.id = {survey_form_question_answer}.survey_form_id"
        relationship: one_to_many
    measures:
      - name: count
        type: count
    dimensions:
      - name: id
        sql: id
        type: number
        primary_key: true
        public: true
      - name: uuid
        sql: '{CUBE}.uuid'
        type: string
      - name: candidateapplicationid
        sql: '{CUBE}.candidate_application_id'
        type: number
      - name: isanonymous
        sql: '{CUBE}.is_anonymous'
        type: boolean
      - name: companyuserid
        sql: '{CUBE}.company_user_id'
        type: number
      - name: candidateprofileid
        sql: '{CUBE}.candidate_profile_id'
        type: number
      - name: surveyformtemplateid
        sql: '{CUBE}.survey_form_template_id'
        type: number
      - name: createdby
        sql: '{CUBE}.created_by'
        type: number
      - name: attemptnumber
        sql: '{CUBE}.attempt_number'
        type: number
      - name: replacedby
        sql: '{CUBE}.replaced_by'
        type: number
      - name: isdeleted
        sql: '{CUBE}.is_deleted'
        type: boolean
      - name: surveyformcompletionstatus
        sql: '{CUBE}.survey_form_completion_status'
        type: string
      - name: surveyformdeliverystatus
        sql: '{CUBE}.survey_form_delivery_status'
        type: string
      - name: respondentscore
        sql: '{CUBE}.respondent_score'
        type: number
      - name: respondedat
        sql: '{CUBE}.responded_at'
        type: time
      - name: expirationdate
        sql: '{CUBE}.expiration_date'
        type: time
      - name: createdat
        sql: '{CUBE}.created_at'
        type: time
      - name: updatedat
        sql: '{CUBE}.updated_at'
        type: time
